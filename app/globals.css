@tailwind base;
@tailwind components;
@tailwind utilities;

/* ---------- Base ---------- */
html, body { height: 100%; }

body {
  background: rgb(255 255 255);               /* fallback for when bg layer hasn't mounted */
  color: rgb(17 24 39);                        /* slate-900-ish for light mode */
}

.dark body {
  background: rgb(3 7 18);                    /* slate-950-ish */
  color: rgb(229 231 235);
}

/* ---------- Helpers / Utilities ---------- */
.section { @apply py-16 md:py-24; }

.h1 { @apply text-3xl md:text-5xl font-bold leading-tight; }
.h2 { @apply text-2xl md:text-4xl font-semibold; }
.mono { @apply font-mono text-sm tracking-tight opacity-80; }

.card {
  @apply rounded-2xl border border-gray-200 dark:border-white/10
         bg-white/90 dark:bg-white/5 backdrop-blur p-6 
         shadow-sm hover:shadow-md transition-shadow;
}

/* Code block light-mode helpers */
.code-wrapper { position: relative; }
.code-colored { display: block; }
.reveal-overlay {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, rgba(255,255,255,0.9), rgba(255,255,255,0.95));
  pointer-events: none;
  transition: width 240ms linear;
}
.caret {
  position: absolute;
  top: 0.6rem;
  width: 2px;
  height: calc(100% - 1.2rem);
  background: rgba(17,24,39,0.85);
  box-shadow: 0 0 8px rgba(99,102,241,0.6);
  transform: translateX(-1px);
  transition: left 120ms linear;
}

/* Dark mode variants for the reveal and caret */
.dark .reveal-overlay { background: linear-gradient(90deg, rgba(3,7,18,0.7), rgba(3,7,18,0.95)); }
.dark .caret { background: rgba(255,255,255,0.85); box-shadow: 0 0 8px rgba(56,189,248,0.55); }

.sr-only { position: absolute !important; height: 1px; width: 1px; overflow: hidden; clip: rect(1px, 1px, 1px, 1px); white-space: nowrap; }

.btn {
  @apply inline-flex items-center gap-2 rounded-full px-4 py-2
         border border-gray-300 dark:border-white/10
         bg-white dark:bg-white/5
         hover:-translate-y-0.5 hover:shadow-md transition-all shadow-sm;
}

/* ---------- Grid background (Light & Dark) ---------- */
:root {
  --grid-size: 72px;
  /* Light mode */
  --light-grid-alpha: 0.03;
  --light-grid-rgb: 0 0 0;           /* dark grid lines */
  --light-bg-rgb: 249 250 251;       /* gray-50 */
  --light-spot-rgb: 99 102 241;      /* indigo-500 glow */
  
  /* Dark mode */
  --dark-grid-alpha: 0.045;
  --dark-grid-rgb: 255 255 255;      /* white grid lines */
  --dark-bg-rgb: 7 11 24;            /* deep navy */
  --dark-spot-rgb: 64 80 255;        /* blue glow */
}

/* Light mode background */
.bg-night-grid {
  background-color: rgb(var(--light-bg-rgb));
  background-image:
    repeating-linear-gradient(0deg,
      rgba(var(--light-grid-rgb) / var(--light-grid-alpha)) 0 1px,
      transparent 1px var(--grid-size)
    ),
    repeating-linear-gradient(90deg,
      rgba(var(--light-grid-rgb) / var(--light-grid-alpha)) 0 1px,
      transparent 1px var(--grid-size)
    ),
    radial-gradient(600px 420px at 12% 8%,
      rgba(var(--light-spot-rgb) / .08) 0,
      rgba(var(--light-spot-rgb) / 0) 60%
    );
  background-repeat: no-repeat, no-repeat, no-repeat;
  background-attachment: fixed;
}

/* Dark mode background */
.dark .bg-night-grid {
  background-color: rgb(var(--dark-bg-rgb));
  background-image:
    repeating-linear-gradient(0deg,
      rgba(var(--dark-grid-rgb) / var(--dark-grid-alpha)) 0 1px,
      transparent 1px var(--grid-size)
    ),
    repeating-linear-gradient(90deg,
      rgba(var(--dark-grid-rgb) / var(--dark-grid-alpha)) 0 1px,
      transparent 1px var(--grid-size)
    ),
    radial-gradient(600px 420px at 12% 8%,
      rgba(var(--dark-spot-rgb) / .35) 0,
      rgba(var(--dark-spot-rgb) / 0) 60%
    ),
    radial-gradient(1000px 800px at 120% -10%,
      rgba(0 0 0 / .5) 0,
      rgba(0 0 0 / 0) 60%
    );
  background-repeat: no-repeat, no-repeat, no-repeat, no-repeat;
  background-attachment: fixed;
}

.bg-night-grid-fade {
  mask-image: radial-gradient(1200px 900px at 50% 40%, black 55%, transparent 100%);
  -webkit-mask-image: radial-gradient(1200px 900px at 50% 40%, black 55%, transparent 100%);
}

@media (max-width: 768px) {
  .bg-night-grid { background-attachment: scroll; }
}
